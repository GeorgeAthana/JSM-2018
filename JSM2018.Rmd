---
title: "A Classification Framework for Forecast-Model Selection"
author: "Thiyanga S. Talagala"
institute: |
        | Professor Rob J Hyndman
        | A/Professor George Athanasopoulos
date: "August 1, 2018"
output: 
  beamer_presentation:
     theme: "Warsaw"
     includes:
        in_header: header_pagenrs.tex
---



```{r initial, echo = FALSE, cache = FALSE, include = FALSE}
library(knitr)
library(pander)
# Set so that long lines in R will be wrapped:
opts_chunk$set(tidy.opts=list(width.cutoff=50),tidy=TRUE)
opts_chunk$set(fig.lp = '')
opts_chunk$set(
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  fig.path = "figure/",
  cache.path = "cache/",
  cache = TRUE,
  fig.show = "hold",
  external = TRUE,
  dev = "png"
)

```

```{r set-options, echo=FALSE, cache=FALSE}
options(width = 50)
```


# Large collections of time series 

  \centerline{\includegraphics[width=\textwidth,height=7.5cm,keepaspectratio]{figures/example.jpg}}

- Forecasting demand for thousands of products across multiple
warehouses.

#
\centerline{\includegraphics[width=\textwidth,height=7.5cm,keepaspectratio]{figures/job1.png}}

source: \url{https://www.r-users.com/jobs/forecasting-multiple-time-series/}

#

\centerline{\includegraphics[width=\textwidth,height=7.5cm,keepaspectratio]{figures/job2.png}}

source: \url{https://www.r-users.com/jobs/forecasting-multiple-time-series/}



# Forecasting multiple time series

  \begin{itemize}[<+->]
\item Use a single method to provide forecasts across all time series.
\begin{itemize}[<+->]
\item No free lunch!
  \end{itemize}
\item Develop a framework to select the most appropriate forecasting method.
\end{itemize}

# Forecasting multiple time series

  \begin{itemize}
\item Use a single method to provide forecasts across all time series.
\begin{itemize}
\item No free lunch!
  \end{itemize}
\item \textcolor{red}{Develop a framework to select the most appropriate forecasting method.}
\end{itemize}

# Motivation

\begin{itemize}[<+->]
\vfill\item Reid(1972) pointed out that the \textbf{performance of various forecasting methods} changes according to the \textcolor{red}{nature of data} and if the reasons for these variations are explored they may be useful in selecting the most appropriate model.
\item "\textbf{What} are the specific \textcolor{red}{time series characteristics} for which each technique is generally best and also \textbf{what} are the \textcolor{red}{time series characteristics} for which it does not really matter which technique is chosen ?" (Lawrence, IJF, 2001)

\end{itemize}

\pause
\begin{block}{Objective}
Develop a framework that automates the selection of the most appropriate forecasting model for a given time series by using a large array of \textcolor{red}{features} computed from the time series.
\end{block}

# Time series features

\textcolor{red}{Cognostics}: \textcolor{red}{Co}mputer-aided dia\textcolor{red}{gnostics}\newline
\hspace{1in}(John W. Tukey, 1985)

\begin{itemize}[<+->]
\item Called “features” or “characteristics” in the machine learning literature.

\item \textbf{Basic idea:}
  
  Transform a given time series $y=\{y_1, y_2, \cdots, y_n\}$ to a feature vector $F = (f_1(y), f_2(y), \cdots, f_p(y))'$. 

\item Examples for time series features

\begin{itemize}[<+->]
\vfill\item strength of trend
\vfill\item strength of seasonality
\vfill\item lag-1 autocorrelation
\vfill\item spectral entropy

\end{itemize}

\end{itemize}


# Feature-space of time series

\begin{block}{STL-decomposition}
$Y_t=T_t+S_t+R_t$
\end{block}

\begin{itemize}
\vfill\item strength of trend: $1-\frac{Var(R_t)}{Var(Y_t-S_t)}$
\vfill\item strength of seasonality: $1-\frac{Var(R_t)}{Va(Y_t-T_t)}$
\end{itemize}

\begincols
\begincol{.48\textwidth}


```{r, warning=FALSE, message=F, echo=FALSE, fig.height=10}
library(Mcomp)
library(ggplot2)
library(grid)
library(gridExtra)
library(ggrepel)
library(png)
library(tsfeatures)
library(tidyverse)
library(ggpubr)

# Extract required series
series_id <- c("N0001", "N0633", "N0625", "N0645","N1912", "N2012")
six_series <- lapply(M3[series_id], function(u){u$x})
p <- lapply(six_series,
function(u) {autoplot(u) + xlab("") + ylab("")}
)
for (i in seq_along(six_series))
p[[i]] <- p[[i]] + ggtitle(series_id[i])+theme(title =element_text(size=30, face='bold'))
grid.arrange(grobs = p, ncol = 2)

```

\endcol \begincol{.48\textwidth}

\pause

```{r fig2, fig.height=10, message=F, echo=F, warning=F}
df <- tsfeatures(six_series, c("stl_features")) %>%
  select(trend, seasonal_strength) %>%
  rename(seasonality = seasonal_strength) %>%
  replace_na(list(seasonality = 0))
df$id <- names(six_series)
ggplot(df, aes(x = trend, y = seasonality)) +
  geom_point(size = 5, color = 'red') +
  xlim(0, 1) + ylim(0, 1) +
  coord_fixed() +
  geom_text_repel(
    aes(label = id),
    colour = "black",
    size = 10,
    box.padding = unit(0.5, "lines")
  ) +
  theme(legend.position = "none")
```

  \endcol
\endcols



# Methodology

\textbf{General framework for forecast-model selection using a meta-learning approach}

\textcolor{red}{Offline}

- Classification algorithm is trained

\textcolor{red}{Online}

- Use the classification algorithm to select appropriate forecast-models for new time series

# Methodology: population

 \centerline{\includegraphics[width=\paperwidth]{figures/fw1.png}}

# Methodology: observed sample

 \centerline{\includegraphics[width=\paperwidth]{figures/fw2.png}}
 
# Methodology: simulated time series

 \centerline{\includegraphics[width=\paperwidth]{figures/fw3.png}}
 
# Methodology: reference set
 
 \centerline{\includegraphics[width=\paperwidth]{figures/fw4.png}}

# Augmenting the observed sample with simulated series

- Time series simulation process

\centerline{\includegraphics[height=2in]{figures/sim2.png}}

\begin{itemize}[<+->]
\vfill\item when our sample is too small to build a reliable classifier
\vfill\item to add more of some types of time series to the training set in order to get a more balanced sample
\vfill\item to increase the diversity and evenness of the feature space
\end{itemize}

# Methodology: reference set
 
 \centerline{\includegraphics[width=\paperwidth]{figures/fw4.png}}
 

# Methodology: Meta-data

\centerline{\includegraphics[width=\paperwidth]{figures/fw5.png}}

# Methodology: Meta-data

\centerline{\includegraphics[width=\paperwidth]{figures/fw6.png}}

# Methodology: Meta-data

\centerline{\includegraphics[width=\paperwidth]{figures/fw7.png}}

# Methodology: Meta-data

\centerline{\includegraphics[width=\paperwidth]{figures/fw8.png}}


# Methodology: Meta-data

\centerline{\includegraphics[width=\paperwidth]{figures/fw9.png}}

# Methodology: Meta-data

\centerline{\includegraphics[width=\paperwidth]{figures/fw10.png}}

# Methodology: Random-forest classifier

\centerline{\includegraphics[width=\paperwidth]{figures/fw11.png}}


# Methodology: "online" part of the algorithm

\centerline{\includegraphics[width=\paperwidth]{figures/fw12.png}}


# Methodology: "online" part of the algorithm

\centerline{\includegraphics[width=\paperwidth]{figures/fw13.png}}

# Methodology: "online" part of the algorithm

\centerline{\includegraphics[width=\paperwidth]{figures/fw14.png}}

# Application to M competition data

- Proposed algorithm is applied to yearly, quarterly and monthly series separately

- We run two experiments for each case.

\begin{table}[!htp]
\centering\footnotesize\tabcolsep=0.2cm
\def\yes{$\checkmark$}
\captionsetup{labelformat=empty}
\label{tbl:Mcomps}
\begin{tabular}{lccccr@{\hspace*{0.3cm}}cccc}
\toprule
                &  \multicolumn{ 4}{c}{Experiment 1} & & \multicolumn{ 4}{c}{Experiment 2} \\
                &    Source  &    Y  & Q  &    M &            &    Source  &    Y  & Q  &    M \\\cline{2-5}\cline{7-10}
& & & & & & & & & \\[-0.25cm]
Observed series &         M1 &        181 &        203 &        617 &            &         M3 &        645 &        756 &       1428 \\
     New series &         M3 &        645 &        756 &       1428 &            &         M1 &        181 &        203 &        617 \\
\bottomrule
\end{tabular}
\end{table}

 

# Application to M competition data

- Simulate time series based on `auto.arima` and `ets`

\begin{table}[!htp]
\centering\tiny\tabcolsep=0.25cm
\def\yes{$\checkmark$}
\captionsetup{labelformat=empty}
\label{tbl:Mcomps}
\begin{tabular}{lccccr@{\hspace*{0.2cm}}cccc}
\toprule
                &  \multicolumn{ 4}{c}{Experiment 1} & & \multicolumn{ 4}{c}{Experiment 2} \\
                &    Source  &    Y  & Q  &    M &            &    Source  &    Y  & Q  &    M \\\cline{2-5}\cline{7-10}
& & & & & & & & & \\[-0.1cm]
Observed series &         M1 &       \textcolor{red}{181} &        203 &        617 &            &         M3 &        645 &        756 &       1428 \\
Simulated series &          &       362000 &        406000 &        123400 &            &          &        1290000 &        1512000&       285600 \\
\bottomrule
\end{tabular}
\end{table}

Example:

Experiment 1 - Yearly

\begin{table}[!htp]
\centering
\captionsetup{labelformat=empty}
\label{sim}
\begin{tabular}{lr}
simulated time series (`ets`) &  181000\\
simulated time series (`auto.arima`) & 181000 \\
Total simulated & 362000
\end{tabular}
\end{table}

# output-labels

\begin{columns}
\begin{column}{0.48\textwidth}
\begin{itemize}
\item White noise process
\item AR/ MA/ ARMA
\item ARIMA
\item Random walk with drift
\item Random walk
\item Theta
\item STL-AR
\item ETS with without trend and seasonal
\item ETS with trend and without seasonal
\item ETS with damped trend and without seasonal
    \end{itemize} 
\end{column}
\begin{column}{0.48\textwidth}
   \begin{itemize}
   \item \textcolor{blue}{ETS with trend and seasonal}
   \item \textcolor{blue}{ETS with damped trend and seasonal}
   \item \textcolor{blue}{ETS with seasonal without trend}
   \item \textcolor{blue}{SARIMA}
   \item \textcolor{blue}{Seasonal naive method}
   \end{itemize} 
\end{column}
\end{columns}
  

# Model calibration

We consider three approaches to address the class imbalance in the data 

\begin{itemize}[<+->]

\vfill\item incorporate class priors into the random forest classifier (Chen, Liaw \& Breiman, 2004)

\vfill\item Balanced random forest

\vfill\item re-balance the reference set with down-sampling
\end{itemize}

\pause
Further, 
\begin{itemize}[<+->]
\vfill\item Random forest classifier built on unbalanced data
\end{itemize}

# Results: Yearly series

25 features: 

\begin{columns}
\begin{column}{0.48\textwidth}
   \begin{itemize}
   \item length
    \item strength of trend
    \item linearity
    \item curvature
    \item spikiness
    \item stability
    \item lumpiness
    \item first ACF value of remainder series
    \item parameter estimates of Holt's linear trend method
    \end{itemize} 
\end{column}
\begin{column}{0.48\textwidth}
   \begin{itemize}
    \item spectral entropy
    \item Hurst exponent
    \item nonlinearity
    \item unit root test statistics
    \item first ACF value of residual series of linear trend model 
    \item ACF and PACF based features - calculated on both the raw and differenced series
    \end{itemize} 
\end{column}
\end{columns}

# Yearly series: correlation matrix plots for the reference sets

```{r, warning=F, message=F, echo=F}
library(tidyverse)
library(ggplot2)
library(reshape2)

YE1 <- load("data/yearly_exp1.rda")

YE2 <- load("data/yearly_exp2.rda")
YE2_sub <- load("data/yearly_exp2_sub.rda")

QE1 <- load("data/quarterly_exp1.rda")

QE2 <- load("data/quarterly_exp2.rda")
QE2_sub <- load("data/quarterly_exp2_sub.rda")

ME1 <- load("data/monthly_exp1.rda")

ME2 <- load("data/monthly_exp2.rda")

yearly_exp1 <- rename(yearly_exp1, spikiness = spike)
yearly_exp2 <- rename(yearly_exp2, spikiness = spike)
quarterly_exp1 <- rename(quarterly_exp1, spikiness = spike)
quarterly_exp2 <- rename(quarterly_exp2, spikiness = spike)
monthly_exp1 <- rename(monthly_exp1, spikiness = spike)
monthly_exp2 <- rename(monthly_exp2, spikiness = spike)

yearly_exp1 <- rename(yearly_exp1,  "T" = N)
yearly_exp2 <- rename(yearly_exp2, "T" = N)
quarterly_exp1 <- rename(quarterly_exp1,  "T" = N)
quarterly_exp2 <- rename(quarterly_exp2,  "T" = N)
monthly_exp1 <- rename(monthly_exp1,  "T" = N)
monthly_exp2 <- rename(monthly_exp2,  "T" = N)


quarterly_exp1 <- rename(quarterly_exp1, seasonality = seasonal_strength)
quarterly_exp2 <- rename(quarterly_exp2, seasonality = seasonal_strength)
monthly_exp1 <- rename(monthly_exp1, seasonality = seasonal_strength)
monthly_exp2 <- rename(monthly_exp2, seasonality = seasonal_strength)

## --- figure 5

cormatA <- round(cor(yearly_exp1[,1:25]),2)
melted_cormatA <- melt(cormatA)
get_lower_triA <- function(cormatA){
  cormatA[upper.tri(cormatA)] <- NA
  return(cormatA)
}
get_upper_triA <- function(cormatA){
  cormatA[lower.tri(cormatA)]<- NA
  return(cormatA)
}
upper_triA <- get_upper_triA(cormatA)
melted_cormatA <- melt(upper_triA, na.rm = TRUE)
ggheatmapA <- ggplot(melted_cormatA, aes(Var2, Var1, fill = value))+
  geom_tile(color = "white")+
  scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
                       midpoint = 0, limit = c(-1,1), space = "Lab", 
                       name="Pearson\nCorrelation") +
  theme_minimal()+ 
  theme(axis.text.x = element_text(angle = 90, vjust = 1, 
                                   size = 9, hjust = 1),
        axis.text.y = element_text(size = 9),
        axis.title.x =  element_blank(),
        axis.title.y = element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(0.6, 0.7),
        legend.direction = "horizontal")+
  coord_fixed()+
  guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
                               title.position = "top", title.hjust = 0.5))+
  ggtitle("E1-Yearly")



cormatB <- round(cor(yearly_exp2[,1:25]),2)
melted_cormatB <- melt(cormatB)
get_lower_triB <- function(cormatB){
  cormatB[upper.tri(cormatB)] <- NA
  return(cormatB)
}
get_upper_triB <- function(cormatB){
  cormatB[lower.tri(cormatB)]<- NA
  return(cormatB)
}
upper_triB <- get_upper_triB(cormatB)
melted_cormatB <- melt(upper_triB, na.rm = TRUE)
ggheatmapB <- ggplot(melted_cormatB, aes(Var2, Var1, fill = value))+
  geom_tile(color = "white")+
  scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
                       midpoint = 0, limit = c(-1,1), space = "Lab", 
                       name="Pearson\nCorrelation") +
  theme_minimal()+ 
  theme(axis.text.x = element_text(angle = 90, vjust = 1, 
                                   size = 9, hjust = 1),
        axis.text.y = element_text(size = 9),
        axis.title.x =  element_blank(),
        axis.title.y = element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(0.6, 0.7),
        legend.direction = "horizontal")+
  coord_fixed()+
  guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
                               title.position = "top", title.hjust = 0.5))+
  ggtitle("E2-Yearly")


cormatC <- round(cor(quarterly_exp1[, 1:30]),2)
get_lower_triC <- function(cormatC){
  cormatC[upper.tri(cormatC)] <- NA
  return(cormatC)
}
get_upper_triC <- function(cormatC){
  cormatC[lower.tri(cormatC)]<- NA
  return(cormatC)
}
upper_triC <- get_upper_triC(cormatC)
melted_cormatC <- melt(upper_triC, na.rm = TRUE)
ggheatmapC <- ggplot(melted_cormatC, aes(Var2, Var1, fill = value))+
  geom_tile(color = "white")+
  scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
                       midpoint = 0, limit = c(-1,1), space = "Lab", 
                       name="Pearson\nCorrelation") +
  theme_minimal()+ 
  theme(axis.text.x = element_text(angle = 90, vjust = 1, 
                                   size = 9, hjust = 1),
        axis.text.y = element_text(size = 9),
        axis.title.x =  element_blank(),
        axis.title.y = element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(0.6, 0.7),
        legend.direction = "horizontal")+
  coord_fixed()+
  guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
                               title.position = "top", title.hjust = 0.5))+
  ggtitle("E1-Quarterly")



cormatD <- round(cor(quarterly_exp2[, 1:30]),2)
get_lower_triD <-function(cormatD){
  cormatD[upper.tri(cormatD)] <- NA
  return(cormatD)
}
get_upper_triD <- function(cormatD){
  cormatD[lower.tri(cormatD)]<- NA
  return(cormatD)
}
upper_triD <- get_upper_triD(cormatD)
melted_cormatD <- melt(upper_triD, na.rm = TRUE)
ggheatmapD <- ggplot(melted_cormatD, aes(Var2, Var1, fill = value))+
  geom_tile(color = "white")+
  scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
                       midpoint = 0, limit = c(-1,1), space = "Lab", 
                       name="Pearson\nCorrelation") +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90, vjust = 1, 
                                   size = 9, hjust = 1),
        axis.text.y = element_text(size = 9),
        axis.title.x =  element_blank(),
        axis.title.y = element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(0.6, 0.7),
        legend.direction = "horizontal")+
  coord_fixed()+
  guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
                               title.position = "top", title.hjust = 0.5))+
  ggtitle("E2-Quarterly")


cormatE <- round(cor(monthly_exp1[, 1:30]),2)
get_lower_triE <- function(cormatE){
  cormatE[upper.tri(cormatE)] <- NA
  return(cormatE)
}
get_upper_triE <- function(cormatE){
  cormatE[lower.tri(cormatE)]<- NA
  return(cormatE)
}
upper_triE <- get_upper_triE(cormatE)
melted_cormatE <- melt(upper_triE, na.rm = TRUE)
ggheatmapE <- ggplot(melted_cormatE, aes(Var2, Var1, fill = value))+
  geom_tile(color = "white")+
  scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
                       midpoint = 0, limit = c(-1,1), space = "Lab", 
                       name="Pearson\nCorrelation") +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90, vjust = 1, 
                                   size = 9, hjust = 1),
        axis.text.y = element_text(size = 9),
        axis.title.x =  element_blank(),
        axis.title.y = element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(0.6, 0.7),
        legend.direction = "horizontal")+
  coord_fixed()+
  guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
                               title.position = "top", title.hjust = 0.5))+
  ggtitle("E1-Monthly")


cormatF <- round(cor(monthly_exp2[, 1:30]),2)
melted_cormatF <- melt(cormatF)
get_lower_triF <- function(cormatF){
  cormatF[upper.tri(cormatF)] <- NA
  return(cormatF)
}
get_upper_triF <- function(cormatF){
  cormatF[lower.tri(cormatF)]<- NA
  return(cormatF)
}
upper_triF <- get_upper_triF(cormatF)
melted_cormatF <- melt(upper_triF, na.rm = TRUE)
ggheatmapF <- ggplot(melted_cormatF, aes(Var2, Var1, fill = value))+
  geom_tile(color = "white")+
  scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
                       midpoint = 0, limit = c(-1,1), space = "Lab", 
                       name="Pearson\nCorrelation") +
  theme_minimal()+ 
  theme(axis.text.x = element_text(angle = 90, vjust = 1, 
                                   size = 9, hjust = 1),
        axis.text.y = element_text(size = 9),
        axis.title.x =  element_blank(),
        axis.title.y = element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(0.6, 0.7),
        legend.direction = "horizontal")+
  coord_fixed()+
  guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
                               title.position = "top", title.hjust = 0.5))+
  ggtitle("E2-Monthly")

grid.arrange(ggheatmapA, ggheatmapB, ncol=2)
```

# Yearly - Experiment 1: Distribution of time series in the PCA space

- observed-M1, \textcolor{ao(english)}{simulated}, \textcolor{orange}{new-M3}

```{r, warning=F, message=F, echo=F, fig.ext='png'}
pcaM1YDF <- filter(yearly_exp1, datasource=="M1") # E-1
pcaM1YDFvariables <- pcaM1YDF[,1:25]
pcaM1Y <- prcomp(pcaM1YDFvariables, center=TRUE, scale=TRUE)
#summary(pcaM1Y)
PC1m1y = pcaM1Y$x[,1]
PC2m1y = pcaM1Y$x[,2]
PC3m1y = pcaM1Y$x[,3]
m1yPCAresults = data.frame(PC1m1y, PC2m1y, PC3m1y,pcaM1YDFvariables)
M1Ysimulated <- filter(yearly_exp1, datasource!="M1")
projectM1Ysimulated <- M1Ysimulated[,1:25]
simulatedPCAM1Y <- scale(projectM1Ysimulated,pcaM1Y$center, pcaM1Y$scale) %*% pcaM1Y$rotation
M1Ypca <- data.frame(PC1=PC1m1y, PC2=PC2m1y, PC3=PC3m1y)
rownames(M1Ypca) <- NULL
SimulatedPCAM1Y <- data.frame(PC1=simulatedPCAM1Y[,1], PC2=simulatedPCAM1Y[,2], PC3=simulatedPCAM1Y[,3])
M3Y <- filter(yearly_exp2, datasource=="M3")
projectM3Y <- M3Y[,1:25]
simM3YPCA <- scale(projectM3Y, pcaM1Y$center,pcaM1Y$scale) %*% pcaM1Y$rotation
M3YPCA <- data.frame(PC1=simM3YPCA[,1], PC2=simM3YPCA[,2], PC3=simM3YPCA[,3])
pcaALLM1Y <- bind_rows(SimulatedPCAM1Y, M3YPCA, M1Ypca, .id="source")
pca1M1Y <- ggplot(pcaALLM1Y, aes(x=PC1, y=PC2, color=source)) + geom_point()+ theme(legend.position="none")+
  scale_color_manual(values=c("forestgreen", "firebrick1", "black"))+theme(aspect.ratio = 1)+theme(plot.margin=grid::unit(c(0,0,0,0), "mm"))

pca2M1Y <- ggplot(pcaALLM1Y, aes(x=PC1, y=PC3, color=source)) + geom_point()+ theme(legend.position="none")+
  scale_color_manual(values=c("forestgreen", "firebrick1", "black"))+theme(aspect.ratio = 1)+theme(plot.margin=grid::unit(c(0,0,0,0), "mm"))

pca3M1Y <- ggplot(pcaALLM1Y, aes(x=PC2, y=PC3, color=source)) + geom_point()+ theme(legend.position="none")+
  scale_color_manual(values=c("forestgreen", "firebrick1", "black"))+theme(aspect.ratio = 1)+theme(plot.margin=grid::unit(c(0,0,0,0), "mm"))

grid.arrange(pca1M1Y, pca2M1Y, pca3M1Y, ncol=3)

```

# Yearly - Experiment 1: Observed-M1, new-M3

\begin{table}[!htbp]
\centering\footnotesize
\captionsetup{labelformat=empty}
\label{YM3}
\begin{tabular}{lrrrrrrr}
\toprule
                & \multicolumn{5}{c}{Yearly: 645 M3 time series} \\ 
                & h= 1         & 1--2      & 1--3      & 1--4      & 1--5     \\ 
\midrule
RF-unbalanced   & 1.06      & 1.40      & 2.17     & 2.82      & 3.50    \\
RF-class priors & \textcolor{red}{1.04} & 1.38     &2.15     & 2.79    & 2.50    \\
auto.arima      & 1.11      & 1.48      & 2.28    & 2.96      & 5.83  \\
ets             & 1.09      & 1.44      &2.20     & 2.86     & 4.67   \\
WN              & 6.54      & 6.91      & 7.48      & 8.07      & 9.00     \\
RW              & 1.24      & 1.68      & 2.48      & 3.17      & 8.00      \\
RWD             & \textcolor{red}{1.03} & \textcolor{red}{1.36} & \textcolor{red}{2.05} & \textcolor{red}{2.63}  & \textcolor{red}{1.00} \\
Theta           & 1.12      & 1.47      & 2.18      & 2.77      & 3.50     \\ \hline
\bottomrule
\end{tabular}
\end{table}

# Yearly - Experiment 2: Distribution of time series in the PCA space

-  \textcolor{ao(english)}{simulated}, \textcolor{aureolin}{subset}, observed-M3, \textcolor{orange}{new-M1}

```{r}


pcaM3YDF <- filter(yearly_exp2, datasource=="M3") # E-2
pcaM3YDFvariables <- pcaM3YDF [,1:25]
pcaM3Y <- prcomp(pcaM3YDFvariables, center=TRUE, scale=TRUE)
#summary(pcaM3Y)
PC1m3y = pcaM3Y$x[,1]
PC2m3y = pcaM3Y$x[,2]
PC3m3y = pcaM3Y$x[,3]
m3yPCAresults = data.frame(PC1m3y, PC2m3y, PC3m3y,pcaM3YDFvariables)
M3Ysimulated <- filter(yearly_exp2, datasource!="M3")
projectM3Ysimulated <- M3Ysimulated[,1:25]
simulatedPCAM3Y <- scale(projectM3Ysimulated,pcaM3Y$center, pcaM3Y$scale) %*% pcaM3Y$rotation
M3Ypca <- data.frame(PC1=PC1m3y, PC2=PC2m3y, PC3=PC3m3y)
rownames(M3Ypca) <- NULL
SimulatedPCAM3Y <- data.frame(PC1=simulatedPCAM3Y[,1], PC2=simulatedPCAM3Y[,2], PC3=simulatedPCAM3Y[,3])
M1Y <- filter(yearly_exp1, datasource=="M1")
projectM1Y <- M1Y[,1:25]
simM1YPCA <- scale(projectM1Y, pcaM3Y$center,pcaM3Y$scale) %*% pcaM3Y$rotation
M1YPCA <- data.frame(PC1=simM1YPCA[,1], PC2=simM1YPCA[,2], PC3=simM1YPCA[,3])
rfsubsample <- load("data/yearly_exp2_sub.rda")
projectM3RFdataSub <- yearly_exp2_sub[,1:25]
M3RFdataSubPCA <- scale(projectM3RFdataSub, pcaM3Y$center,pcaM3Y$scale) %*% pcaM3Y$rotation
subsamplePCA <- data.frame(PC1=M3RFdataSubPCA[,1], PC2=M3RFdataSubPCA[,2], PC3=M3RFdataSubPCA[,3])
pcaALLM3Y <- bind_rows(SimulatedPCAM3Y, subsamplePCA, M3Ypca,M1YPCA, .id="source")
pca1M3Y <- ggplot(pcaALLM3Y, aes(x=PC1, y=PC2, color=source)) + geom_point()+ theme(legend.position="none")+
  scale_color_manual(values=c("forestgreen", "yellow", "black", "firebrick1"))+theme(aspect.ratio = 1)

pca2M3Y <- ggplot(pcaALLM3Y, aes(x=PC1, y=PC3, color=source)) + geom_point()+ theme(legend.position="none")+
  scale_color_manual(values=c("forestgreen", "yellow" ,"black", "firebrick1"))+theme(aspect.ratio = 1)
pca3M3Y <- ggplot(pcaALLM3Y, aes(x=PC2, y=PC3, color=source)) + geom_point()+ theme(legend.position="none")+
  scale_color_manual(values=c("forestgreen", "yellow", "black", "firebrick1" ))+theme(aspect.ratio = 1)

grid.arrange(pca1M3Y, pca2M3Y, pca3M3Y, ncol=3)


```



# Yearly - Experiment 2: observed-M3, new-M1


\begin{table}[!htbp]
\centering\footnotesize
\captionsetup{labelformat=empty}
\label{YM1}
\begin{tabular}{lrrrrrrr}
\toprule
 & \multicolumn{5}{c}{Yearly: 181 M1 time series} \\ 
                &  h=1         & 1--2       & 1--4       & 1--6      & Average Rank \\
\midrule
RF-unbalanced   & \textcolor{red}{0.98} & \textcolor{red}{1.40} & 2.43      & 3.39      & 1.50      \\
RF-class priors & 1.01      & 1.40      & \textcolor{red}{2.43} & \textcolor{red}{3.38} & \textcolor{red}{1.50}  \\
auto.arima      & 1.06      & 1.47      & 2.51     & 3.47     & 3.33  \\
ets             & 1.12      & 1.59      & 2.72      & 3.77     & 5.00 \\
WN              & 6.38     & 7.08      & 8.59     & 10.01     & 8.00 \\
RW              & 1.35      & 2.00      & 3.50     & 4.89     & 7.00 \\
RWD             & 1.04     & 1.44      & 2.51      &3.49     & 3.67   \\
Theta           & 1.15      & 1.70      & 3.00      & 4.19      & 6.00  \\
\bottomrule
\end{tabular}
\end{table}


# Results: quarterly and monthly series

30 features: 


\begin{columns}
\begin{column}{0.48\textwidth}
   \begin{itemize}
   \item length
    \item strength of seasonality
    \item strength of trend
    \item linearity
    \item curvature
    \item spikiness
    \item stability
    \item lumpiness
    \item first ACF value of remainder series
    \item parameter estimates of Holt's linear trend method
    \end{itemize} 
\end{column}
\begin{column}{0.48\textwidth}
   \begin{itemize}
    \item spectral entropy
    \item Hurst exponent
    \item nonlinearity
    \item parameter estimates of Holt-Winters' additive method
    \item unit root test statistics
    \item first ACF value of residual series of linear trend model 
    \item ACF and PACF based features - calculated on both the raw and differenced series
    \end{itemize} 
\end{column}
\end{columns}


# Quarterly series: correlation matrix plots for the reference sets

```{r, warning=F, message=F, echo=F}
grid.arrange(ggheatmapC, ggheatmapD, ncol=2)
```

# Monthly series: correlation matrix plots for the reference sets

```{r, warning=F, message=F, echo=F}
grid.arrange(ggheatmapE, ggheatmapF, ncol=2)
```

# Quarterly - Experiment 1: Distribution of time series in the PCA space

- observed-M1, \textcolor{ao(english)}{simulated}, \textcolor{orange}{new-M3}

```{r}
pcaM1QDF <- filter(quarterly_exp1, datasource=="M1")
pcaM1QDFvariables <- pcaM1QDF[,1:30]
pcaM1Q <- prcomp(pcaM1QDFvariables, center=TRUE, scale=TRUE)
#summary(pcaM1Q)
PC1m1q = pcaM1Q$x[,1]
PC2m1q = pcaM1Q$x[,2]
PC3m1q = pcaM1Q$x[,3]
m1qPCAresults = data.frame(PC1m1q, PC2m1q, PC3m1q,pcaM1QDFvariables)
M1Qsimulated <- filter(quarterly_exp1, datasource!="M1")
projectM1Qsimulated <- M1Qsimulated[, 1:30]
simulatedPCAM1Q <- scale(projectM1Qsimulated,pcaM1Q$center, pcaM1Q$scale) %*% pcaM1Q$rotation
M1Qpca <- data.frame(PC1=PC1m1q, PC2=PC2m1q, PC3=PC3m1q)
rownames(M1Qpca) <- NULL
SimulatedPCAM1Q <- data.frame(PC1=simulatedPCAM1Q[,1], PC2=simulatedPCAM1Q[,2], PC3=simulatedPCAM1Q[,3])
M3Q <- filter(quarterly_exp2, datasource=="M3")
projectM3Q <- M3Q[,1:30]
simM3QPCA <- scale(projectM3Q, pcaM1Q$center,pcaM1Q$scale) %*% pcaM1Q$rotation
M3QPCA <- data.frame(PC1=simM3QPCA[,1], PC2=simM3QPCA[,2], PC3=simM3QPCA[,3])
pcaALLM1Q <- bind_rows(SimulatedPCAM1Q, M3QPCA, M1Qpca, .id="source")
pca1M1Q <- ggplot(pcaALLM1Q, aes(x=PC1, y=PC2, color=source)) + geom_point()+ theme(legend.position="none")+
  scale_color_manual(values=c("forestgreen", "firebrick1", "black"))+theme(aspect.ratio = 1)

pca2M1Q <- ggplot(pcaALLM1Q, aes(x=PC1, y=PC3, color=source)) + geom_point()+ theme(legend.position="none")+
  scale_color_manual(values=c("forestgreen", "firebrick1", "black"))+theme(aspect.ratio = 1)

pca3M1Q <- ggplot(pcaALLM1Q, aes(x=PC2, y=PC3, color=source)) + geom_point()+ theme(legend.position="none")+
  scale_color_manual(values=c("forestgreen", "firebrick1", "black"))+theme(aspect.ratio = 1)

grid.arrange(pca1M1Q, pca2M1Q, pca3M1Q, ncol=3)
```

# Quarterly - Experiment 1: observed-M1, new-M3


\begin{table}[!htbp]
\centering\footnotesize
\captionsetup{labelformat=empty}
\label{QM1}
\begin{tabular}{lrrrrrrr}
\toprule
 & \multicolumn{5}{c}{Quarterly: 756 M3 time series} \\ 
                & h=1         & 1--4     & 1--6      & 1--8        & Average Rank \\
\midrule
RF-unbalanced   & 0.59 & \textcolor{red}{0.81} & \textcolor{red}{0.97} & \textcolor{red}{1.12}  & 2.25 \\
RF-class priors & 0.59      & 0.82    & 0.97 & 1.13 & 3.13  \\
auto.arima      & 0.59     & 0.85     & 1.02     & 1.19     & 4.75      \\
ets             & \textcolor{red}{0.56}     & 0.82     & 0.99     & 1.17      & 3.75\\
WN              & 3.25      & 3.59      & 3.70      & 3.87    & 10.00    \\
RW              & 1.14      & 1.16      & 1.32     & 1.46      & 7.00 \\
RWD             & 1.20      & 1.17     & 1.36    & 1.47     &6.50   \\
STL-AR          & 0.70      & 1.27      & 1.60      &1.91     & 8.34   \\
Theta           & 0.62      & 0.83     & 0.97     & 1.11     & 2.50 \\
Snaive          & 1.11      & 1.09      & 1.30      & 1.43      & 6.75 \\
\bottomrule
\end{tabular}
\end{table}

# Quarterly - Experiment 2: Distribution of time series in the PCA space

-  \textcolor{ao(english)}{simulated}, \textcolor{aureolin}{subset}, observed-M3, \textcolor{orange}{new-M1}

```{r}

pcaM3QDF <- filter(quarterly_exp2, datasource=="M3") #QE-2
pcaM3QDFvariables <- pcaM3QDF[, 1:30]
pcaM3Q <- prcomp(pcaM3QDFvariables, center=TRUE, scale=TRUE)
#summary(pcaM3Q)
PC1m3q = pcaM3Q$x[,1]
PC2m3q = pcaM3Q$x[,2]
PC3m3q = pcaM3Q$x[,3]
m3qPCAresults = data.frame(PC1m3q, PC2m3q, PC3m3q,pcaM3QDFvariables)
M3Qsimulated <- filter(quarterly_exp2, datasource!="M3")
projectM3Qsimulated <- M3Qsimulated[,1:30]
simulatedPCAM3Q <- scale(projectM3Qsimulated,pcaM3Q$center, pcaM3Q$scale) %*% pcaM3Q$rotation
M3Qpca <- data.frame(PC1=PC1m3q, PC2=PC2m3q, PC3=PC3m3q)
rownames(M3Qpca) <- NULL
SimulatedPCAM3Q <- data.frame(PC1=simulatedPCAM3Q[,1], PC2=simulatedPCAM3Q[,2], PC3=simulatedPCAM3Q[,3])
M1Q <- filter(quarterly_exp1, datasource=="M1")
projectM1Q <- M1Q[,1:30]
simM1QPCA <- scale(projectM1Q, pcaM3Q$center,pcaM3Q$scale) %*% pcaM3Q$rotation
M1QPCA <- data.frame(PC1=simM1QPCA[,1], PC2=simM1QPCA[,2], PC3=simM1QPCA[,3])
projectM3QRFdataSub <- quarterly_exp2_sub[,1:30]
M3QRFdataSubPCA <- scale(projectM3QRFdataSub, pcaM3Q$center,pcaM3Q$scale) %*% pcaM3Q$rotation
subsamplePCAQ <- data.frame(PC1=M3QRFdataSubPCA[,1], PC2=M3QRFdataSubPCA[,2], PC3=M3QRFdataSubPCA[,3])
pcaALLM3Q <- bind_rows(SimulatedPCAM3Q, subsamplePCAQ, M3Qpca, M1QPCA, .id="source")
pca1M3Q <- ggplot(pcaALLM3Q, aes(x=PC1, y=PC2, color=source)) + geom_point()+ theme(legend.position="none")+
  scale_color_manual(values=c("forestgreen", "yellow", "black", "firebrick1"))+theme(aspect.ratio = 1)
pca2M3Q <- ggplot(pcaALLM3Q, aes(x=PC1, y=PC3, color=source)) + geom_point()+ theme(legend.position="none")+
  scale_color_manual(values=c("forestgreen", "yellow", "black", "firebrick1"))+theme(aspect.ratio = 1)

pca3M3Q <- ggplot(pcaALLM3Q, aes(x=PC2, y=PC3, color=source)) + geom_point()+ theme(legend.position="none")+
  scale_color_manual(values=c("forestgreen", "yellow", "black", "firebrick1"))+theme(aspect.ratio = 1)

grid.arrange(pca1M3Q, pca2M3Q, pca3M3Q, ncol=3)
```

# Quarterly - Experiment 2: observed-M3, new-M1


\begin{table}[!htbp]
\centering\footnotesize
\captionsetup{labelformat=empty}
\label{QM3}
\begin{tabular}{lrrrrrrr}
\toprule
 & \multicolumn{5}{c}{Quarterly: 203 M1 time series} \\ 
                &  h=1         & 1--4      & 1--6     & 1--8         & Average Rank \\
\midrule
RF-unbalanced   & \textcolor{red}{0.74} & \textcolor{red}{1.08} & \textcolor{red}{1.35}      & \textcolor{red}{1.57}       & 1.00 \\
RF-class priors & 0.76     & 1.12      & 1.40 & 1.62 & 2.63  \\
auto.arima      & 0.78     & 1.17      & 1.50    & 1.74   & 5.25\\
ets             & 0.78      & 1.11      & 1.42      & 1.66       & 3.00\\
WN              & 3.97      & 4.27     & 4.45      & 4.64     & 10.00\\
RW              & 0.97      & 1.35      & 1.67     & 1.95      & 7.50\\
RWD             & 0.95      & 1.26     & 1.56      & 1.81      & 5.38 \\
STL-AR          & 0.96      & 1.63      & 2.05   & 2.43      & 8.63 \\
Theta           & 0.79      & 1.13      & 1.42      & 1.67  & 3.88 \\
Snaive           & 1.52     & 1.56      & 1.87     &2.08    & 7.75 \\
\bottomrule
\end{tabular}
\end{table}

# Monthly - Experiment 1: Distribution of time series in the PCA space

- observed-M1, \textcolor{ao(english)}{simulated}, \textcolor{orange}{new-M3}

```{r}
pcaM1MDF <- filter(monthly_exp1, datasource=="M1") # M-E1
pcaM1MDFvariables <- pcaM1MDF[,1:30]
pcaM1M <- prcomp(pcaM1MDFvariables, center=TRUE, scale=TRUE)
#summary(pcaM1M)
PC1m1m = pcaM1M$x[,1]
PC2m1m = pcaM1M$x[,2]
PC3m1m = pcaM1M$x[,3]
m1mPCAresults = data.frame(PC1m1m, PC2m1m, PC3m1m,pcaM1MDFvariables)
M1Msimulated <- filter(monthly_exp1, datasource!="M1")
projectM1Msimulated <- M1Msimulated[, 1:30]
simulatedPCAM1M <- scale(projectM1Msimulated,pcaM1M$center, pcaM1M$scale) %*% pcaM1M$rotation
M1Mpca <- data.frame(PC1=PC1m1m, PC2=PC2m1m, PC3=PC3m1m)
rownames(M1Mpca) <- NULL
SimulatedPCAM1M <- data.frame(PC1=simulatedPCAM1M[,1], PC2=simulatedPCAM1M[,2], PC3=simulatedPCAM1M[,3])
M3M <- filter(monthly_exp2, datasource=="M3")
projectM3M <- M3M[, 1:30]
simM3MPCA <- scale(projectM3M, pcaM1M$center,pcaM1M$scale) %*% pcaM1M$rotation
M3MPCA <- data.frame(PC1=simM3MPCA[,1], PC2=simM3MPCA[,2], PC3=simM3MPCA[,3])
pcaALLM1M <- bind_rows(SimulatedPCAM1M, M3MPCA, M1Mpca, .id="source")
pca1M1M <- ggplot(pcaALLM1M, aes(x=PC1, y=PC2, color=source)) + geom_point()+ theme(legend.position="none")+
	scale_color_manual(values=c("forestgreen", "firebrick1", "black"))+theme(aspect.ratio = 1)

pca2M1M <- ggplot(pcaALLM1M, aes(x=PC1, y=PC3, color=source)) + geom_point()+ theme(legend.position="none")+
	scale_color_manual(values=c("forestgreen", "firebrick1", "black"))+theme(aspect.ratio = 1)

pca3M1M <- ggplot(pcaALLM1M, aes(x=PC2, y=PC3, color=source)) + geom_point()+ theme(legend.position="none")+
	scale_color_manual(values=c("forestgreen", "firebrick1", "black"))+theme(aspect.ratio = 1)

grid.arrange(pca1M1M, pca2M1M, pca3M1M, ncol=3)

```


\begin{table}[!h]
\centering\footnotesize
\captionsetup{labelformat=empty}
\label{M3M}
\begin{tabular}{lrrrrrrrr}
\toprule
 & \multicolumn{5}{c}{Monthly: 1428 M3 time series}    &  \\ 
                & h=1      & 1--6      & 1--12      & 1--18      & Average rank  \\
\midrule
RF-unbalanced   & 0.60      & 0.68      & 0.76      & 0.87     & 3.22 \\
RF-class priors & 0.60      & 0.67     & 0.75     & \textcolor{red}{0.86}      & \textcolor{red}{2.00}   \\ auto.arima & \textcolor{red}{0.55} & \textcolor{red}{0.64} & \textcolor{red}{0.74} & \textcolor{red}{0.87} & \textcolor{red}{2.83}   \\
ets             & \textcolor{red}{0.55} & \textcolor{red}{0.64} & \textcolor{red}{0.74} & \textcolor{red}{0.86} & \textcolor{red}{2.72}  \\
WN              & 2.01      & 2.08      & 2.15      & 2.27      & 10.00     \\
RW              & 0.84     & 0.97      & 1.04     & 1.17     & 8.03    \\
RWD             & 0.84      & 0.96      & 1.02      & 1.14      & 6.89   \\
STL-AR          & 0.64      & 0.81      & 1.04      & 1.27      & 7.89   \\
Theta           & 0.58      & 0.67      & 0.77      & 0.89      & 4.22    \\
Snaive          & 0.95      & 0.97      & 0.99      & 1.15      & 7.19   \\
\bottomrule
\end{tabular}
\end{table}

# Monthly - Experiment 2: Distribution of time series in the PCA space

- observed-M3, \textcolor{ao(english)}{simulated}, \textcolor{orange}{new-M1}

```{r}

pcaM3MDF <- filter(monthly_exp2, datasource=="M3") #ME-2
pcaM3MDFvariables <- pcaM3MDF[,1:30]
pcaM3M <- prcomp(pcaM3MDFvariables, center=TRUE, scale=TRUE)
#summary(pcaM3M)
PC1m3m = pcaM3M$x[,1]
PC2m3m = pcaM3M$x[,2]
PC3m3m = pcaM3M$x[,3]
m3mPCAresults = data.frame(PC1m3m, PC2m3m, PC3m3m,pcaM3MDFvariables)
M3Msimulated <- filter(monthly_exp2, datasource!="M3")
projectM3Msimulated <- M3Msimulated[,1:30]
simulatedPCAM3M <- scale(projectM3Msimulated,pcaM3M$center, pcaM3M$scale) %*% pcaM3M$rotation
M3Mpca <- data.frame(PC1=PC1m3m, PC2=PC2m3m, PC3=PC3m3m)
rownames(M3Mpca) <- NULL
SimulatedPCAM3M <- data.frame(PC1=simulatedPCAM3M[,1], PC2=simulatedPCAM3M[,2], PC3=simulatedPCAM3M[,3])
M1M <- filter(monthly_exp1, datasource=="M1")
projectM1M <- M1M[, 1:30]
simM1MPCA <- scale(projectM1M, pcaM3M$center,pcaM3M$scale) %*% pcaM3M$rotation
M1MPCA <- data.frame(PC1=simM1MPCA[,1], PC2=simM1MPCA[,2], PC3=simM1MPCA[,3])
pcaALLM3M <- bind_rows(SimulatedPCAM3M, M1MPCA, M3Mpca, .id="source")
pca1M3M <- ggplot(pcaALLM3M, aes(x=PC1, y=PC2, color=source)) + geom_point()+ theme(legend.position="none")+
	scale_color_manual(values=c("forestgreen", "firebrick1", "black"))+theme(aspect.ratio = 1)
#ggsave("figures/pca1M3M.png")
pca2M3M <- ggplot(pcaALLM3M, aes(x=PC1, y=PC3, color=source)) + geom_point()+ theme(legend.position="none")+
	scale_color_manual(values=c("forestgreen", "firebrick1", "black"))+theme(aspect.ratio = 1)
#ggsave("figures/pca2M3M.png")
pca3M3M <- ggplot(pcaALLM3M, aes(x=PC2, y=PC3, color=source)) + geom_point()+ theme(legend.position="none")+
	scale_color_manual(values=c("forestgreen", "firebrick1", "black"))+theme(aspect.ratio = 1)
#ggsave("figures/pca3M3M.png")

grid.arrange(pca1M3M, pca2M3M, pca3M3M, ncol=3)

```

# Monthly - Experiment 2: observed-M3, new-M1



\begin{table}[!h]
\centering\footnotesize
\captionsetup{labelformat=empty}
\label{M1M}
\begin{tabular}{lrrrrrrrl}
\toprule
 & \multicolumn{5}{c}{Monthly: 617 M1 time series}    &  \\ 
                & h=1     & 1--6      & 1--12      & 1--18    & Average rank  \\
\midrule
RF-unbalanced   & 0.61     & 0.76      & 0.90      & 1.03      & \textcolor{red}{ 1.77}  \\
RF-class priors & 0.60     & 0.75      & 0.92      & 1.06     & 2.83 \\
auto.arima      & 0.60      & 0.76      & 0.96      & 1.12      & 4.94   \\
ets             & \textcolor{red}{0.59}      & 0.76      & 0.93      & 1.07     & 3.44     \\
WN              & 1.93     & 2.09      & 2.18     & 2.28    & 10.00   \\
RW              & 1.05     & 1.24      & 1.33     & 1.47     & 7.25  \\
RWD             & 1.06     & 1.27      & 1.39   & 1.40      & 1.39      \\
STL-AR          & 0.63    & 0.91      & 1.17     & 1.39      & 7.38   \\
Theta           & 0.61 & \textcolor{red}{0.75} & 0.92 & 1.04& 2.27    \\
Snaive          & 1.06      & 1.11      & 1.14     & 1.31      & 6.47  \\
\bottomrule
\end{tabular}
\end{table}


# Discussion and Conclusions

\begin{itemize}[<+->]

\vfill\item Proposed a novel framework for forecast-model selection using meta-learning based on time series features.

\vfill\item Our method almost always performs better than common benchmark methods, and better than the best-performing methods from the M3 competition.

\vfill\item The framework is general and can be applied to any large collection of time series.

\vfill\item Advantage: Not necessary to estimate several different models for the data and undertake an empirical evaluation of their forecast accuracy on a given time series.

\end{itemize}


